\documentclass{article}
\usepackage[]{url}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{mathtools}
\usepackage{tikz}
\usepackage{subcaption}
\usepackage{float}

\begin{document}
\title{Collective motion of squirmers in confined environments}
\author{Roth Robin\\
\\
Supervisors: Van Landeghem CÃ©line, Giraldi Laetitia,\\ Agathe Chouippe}
\date{May, 2024}
\maketitle

\tableofcontents

\section{Introduction}
This internship is the continuation of a project realised during the year. The main goal of the project was
to develop numerical methods for driving micro-robots composed of magnetic heads and flexible tails imitating spermatozoa, reffered to as squirmers.\\
A python code has been implemented during the project, it simulates the behaviors of two interacting squirmers by computing 
the forces and torques present.\\
\section{Context}
The collective behavior of active particles is well studied in the literature. 
The Vicsek model is frequently used to model these active particles. 
The aim of this internship is to perform a similar study considering squirmers, 
in various confined domains and to compare the collective motion of the squirmers with that of the active particles using the Vicsek model. 
The motion of the squirmers is simulated using two different models: a continuous model that approximates hydrodynamic and 
steric forces, and a full model using the finite element library Feel++.

\section{Objectives}
The main goal is to model the dynamics of a schoal of squirmers within confined environments, a channel or a box and to
 study the parameter that affect the alignement of the squirmers.

\section{Vicsek}
\subsection{Model}
\begin{center}
    \begin{tikzpicture}
        \draw[color=green, very thick](0,0) circle (2);
        \node at (-0.2,-0.2) {{$r_i$}};
        \filldraw[color=black, fill=black, very thick](0,0) circle(0.1);
        \filldraw[color=black, fill=black, very thick](-1.5,0.2) circle(0.1);
        \filldraw[color=black, fill=black, very thick](0.5,2.3) circle(0.1);
        \filldraw[color=black, fill=black, very thick](2.6,0) circle(0.1);
        \filldraw[color=black, fill=black, very thick](-0.2,-1.8) circle(0.1);
        \filldraw[color=black, fill=black, very thick](0.6,-0.3) circle(0.1);
        \filldraw[color=black, fill=black, very thick](-1.2,-0.4) circle(0.1);
        \filldraw[color=black, fill=black, very thick](-2.8,1.5) circle(0.1);
        \filldraw[color=black, fill=black, very thick](0.3,-2.2) circle(0.1);
        \filldraw[color=black, fill=black, very thick](0.1,2.8) circle(0.1);
        \draw[thick, -, color=black!60] (0,0) -- (2,0);
        \node at (1,-0.2) {{$R$}};
        % Length of the arrow
        \pgfmathsetmacro{\len}{sqrt(1.28)}

        % Draw arrows with random directions
        \foreach \x/\y in {-1.5/0.2, 0.5/2.3, 2.6/0, -0.2/-1.8, -1.2/-0.4, -2.8/1.5, 0.3/-2.2, 0.1/2.8} {
            \pgfmathsetmacro{\angle}{random()*360}
            \draw[thick, ->, color=green] (\x,\y) -- ++({\len*cos(\angle)},{\len*sin(\angle)});
        }
        \draw[thick, ->, color=green] (0,0) -- (0.8,0.8);
        \draw[thick, ->, color=green] (0.6, -0.3) -- ++ ({\len*cos(-1.04)},{\len*sin(-1.04)});
        \node [color=black] at (0.2,0.5) {{$\vec{v}_i$}};
        \draw[thick, ->, color=black] (0.8, 0) arc (0:45:0.8);
        \node at (1, 0.3) {{$\theta_i$}};
    \end{tikzpicture}
\end{center}

The Vicsek model consists of $N$ particles with $r_i(t)$ and $\theta_i(t)$ 
their position, velocity and orientation.\\
All particles have the same velocity $v_0$ and radius.
The evolution of the orientation $\theta_i(t)$ at each time step $\nabla t$ is:
$$\theta_i(t + \nabla t) = \langle\theta_j(t)\rangle_{|r_i(t) - r_j(t)| < R} + \epsilon_i(t)$$
with
$$\langle\theta_j(t)\rangle = \arctan\left(\frac{\sin(\theta_j(t))}{\cos(\theta_j(t))}\right)$$
$R$ the range of interaction, $\langle\theta_j(t)\rangle_{|r_i(t) - r_j(t)| < R}$ the average 
orientation of the particles in the range $R$ of
 the $i$-the particle (including itself) at the time $t$ and $\epsilon_i(t)$ represents the noise, 
 it's a random number taken from a uniform probability distribution
over $\left(-\frac{\eta}{2}, \frac{\eta}{2}\right)$.\\
The parameter $\eta$ is the main tool that counteracts the alignment of the particles.\\
\\
The evolution of the position $r_i(t)$ at each time step $\nabla t$ is:
$$ r_i(t + \nabla t) = r_i(t) + v_0\nabla t \begin{pmatrix}
    \cos(\theta_i(t))\\
    \sin(\theta_i(t))
\end{pmatrix}$$
The velocity is described by $\vec{v}_i(t)$ which is defined by
$$\vec{v}_i(t) = v_0\begin{pmatrix}
    \cos\theta_i(t)\\
    \sin\theta_i(t)
\end{pmatrix}$$
The behavior of the particles are quantified by the polar order parameter $v_a$ which is calculated with:
$$v_a = \frac{1}{Nv_0}\left|\sum^{N}_{i=1}\vec{v}_i\right|$$

\subsection{Implementation}
The Vicsek model is implemented in the file \texttt{Code/vicsek.py} as a class 
for a square system with repulsive borders
\subsubsection*{Parameters}
\begin{itemize}
    \item $N$ the number of particles in the system
    \item $R$ the range of interaction of the particles
    \item $L$ the length of the system
    \item $v0$ the constant velocity of the particles
    \item $radius$ the radius of the particles
    \item $T$ the time of simulation
    \item $dt$ the time step between each iteration
    \item $noise$ the $\eta$ parameter, used to counteract the alignment of the particles
    \item $beta$ is a parameter which initializes the Squirmers but
    is not used
\end{itemize}
When called, the class initializes $N$ particles with random position and orientation within the square.
\subsubsection*{Methods}
\begin{itemize}
    \item \texttt{distance(p1, p2)} returns the distance between the two particles in argument
    \item \texttt{dist\_particles(particle)} returns a list of the distance between the particle in argument and all of the other ones
    \item \texttt{how\_many\_in\_square()} prints and returns the percentage of particles inside the square. It is
    used to test if the code contains errors.
    \item \texttt{ploar\_order\_parameter()} computes and returns $v_a$ the polar order parameter
    \item \texttt{ref\_border\_x(particle, boundary)} and \texttt{ref\_border\_y(particle, boundary)}
    simulates the reflective borders
    \item \texttt{vector\_x(p1, p2)} and \texttt{vector\_y(p1, p2)} returns respectively the vector in the x and y axis of the
    two particles in argument
    \item \texttt{average\_orient(particle)} returns the average orientation of the particles in a range $R$ of the particle in argument (including itself)
    \item \texttt{update\_orient()} computes the orientation $\theta_i(t + \nabla t)$ by using \texttt{average\_orient}
    \item \texttt{update\_position()} computes the position $r_i(t + \nabla t)$ and uses the reflective borders if necessary
    \item \texttt{loop\_time()} uses \texttt{update\_orientation()} and \texttt{update\_position()} for each time step $dt$
    \item \texttt{plot(ax)} plots the square and the particles in the ax
\end{itemize}

\newpage
\section{InteractingSquirmers}
During this section the improvements to the code and the simulations will be explained.\\

\subsection{$E_0$ parameter}
The first thing done during the internship was to study the effect of the $E_0$ parameter on the alignment of the squirmers.\\
One can see the simulations done and their resulting graphs in the \texttt{graphs/Eo\_analysis} and \texttt{videos/Eo\_analysis} directories.\\
One also can type:
\begin{verbatim}
    python3 Code/run.py Eo_sim 2 filename
\end{verbatim}
and modify the \texttt{Code/run.py} file with the parameters one wants to test,
 then for each $E_0$ in \texttt{Code/run.py} and each $orient2$ and $betas$ in \texttt{sim\_Eo\_param} in \texttt{Code/simulation.py}, 
 a simulation is done and the resulting graphs or videos are stored in the \texttt{graphs} or \texttt{videos} 
 directory depending on one's choice.\\

\subsubsection{Evolution of orientation}
The evolution of the orientation of one squirmer is given by : 
$$
\frac{d \theta_i}{dt} = \sum \Gamma_{ij->i} + \sum \Gamma_{ji->i} +  \Gamma_{i}^W.
$$
$\Gamma_{ij->k}$ is the torque exerted on the $k^\mathrm{th}$ particle by the flow associated to the $i^\mathrm{th}$ particle, but perturbed by the presence of the $j^\mathrm{th}$ particle.\\

\vspace{0.5cm}

The torques acting on the squirmer $i$ can be calculated explicitly by: \\
$$
\Gamma_{ij->i} = E_0(1 + \beta_i e_{ij})(-\ln\epsilon)\hat{e}_{ij}\times \hat{e}_i \cite{Lauga}
$$
and
$$
\Gamma_{ji->i} = \frac{1}{4}E_0(1 + \beta_j e_{ji})(-\ln\epsilon)\hat{e}_{ji}\times \hat{e}_j \cite{Lauga}
$$
with $\hat{e}_{ij} = \frac{(x_j - x_i)}{||x_j - x_i||}$, $e_{ij} = \hat{e}_i\cdot \hat{e}_{ij}$ and $E_0$ the parameter to test.\\ 
For squirmers having the same $\beta$ parameter we note the following relation:
$$
\Gamma_{ji->i} = \frac{1}{4}\Gamma_{ij->i}
$$
We want to study the effect of $E_0$ on the alignment of squirmers in an open environment so $\Gamma_{i}^W$, which is the torque 
exerted by a wall on the squirmer, is not used.

\subsubsection{Numerical Experiments}
The simulations are done with two squirmers placed at coordinates $(x_1, y_1) = (-a, 0)$ and $(x_2, y_2) = (\frac{2a}{1.5}, 0)$ with radius $a=0.05$, velocity $v_0=1$, viscosity $\mu = 1$, $\beta$ varying from $\beta_1 = 0$,
 $\beta_2 = -7.5$ and $\beta_3 = 7.5$, orientation $\theta_1 = \frac{\pi}{2}$ and $\theta_2$ varying between the major orientations of the unit circle.\\
 The value chosen for the $E_0$ parameter are chosen from the previous studies or to test the impact of larger values on the squirmers, such as:
 $$
 E_{0_{1}} = \frac{3}{10}\frac{v_0}{a}, E_{0_{2}} = \frac{8}{5}\mu\pi a^2 \cite{Brumley}, E_{0_{3}} = \frac{-3}{2}\frac{v_0}{a} \cite{Lauga},
 E_{0_{4}} = -E_{0_{1}}, E_{0_{5}} = -5$$
 $$
 E_{0_{6}} = \frac{5}{1000}, E_{0_{7}} = -2, E_{0_{8}} = -\frac{1}{2}, E_{0_{9}} = -E_{0_{8}}
 $$
The focus is for $\theta_2 = \pi$ and $\theta_2 = \frac{3\pi}{4}$ as the interactions are the biggest when the two squirmers are about to collide.
\begin{figure}[H]
    \centering
    \textbf{$\beta_1$ and $\theta_2 = \pi$}\par\medskip
    \begin{minipage}{0.49\textwidth}
        \includegraphics[width=1\textwidth]{graphs/Eo_analysis/beta0/pi_/pi_Eo_brumley.png}
        \caption{\footnotesize Simulation parameters: $a=0.05$, $v_0=1$, $\beta_1=0$, $\mu=1$ and $E_{0_{2}}=\frac{8}{5}\mu\pi a^2$}
    \end{minipage}\hfill
    \begin{minipage}{0.49\textwidth}
        \includegraphics[width=1\textwidth]{graphs/Eo_analysis/beta0/pi_/pi_Eo_init.png}
        \caption{\footnotesize Simulation parameters: $a=0.05$, $v_0=1$, $\beta_1=0$, $\mu=1$ and $E_{0_{1}}=\frac{3}{10}\frac{v_0}{a}$}
    \end{minipage}
    \begin{minipage}{0.49\textwidth}
        \includegraphics[width=1\textwidth]{graphs/Eo_analysis/beta0/pi_/pi_m2.png}
        \caption{\footnotesize Simulation parameters: $a=0.05$, $v_0=1$, $\beta_1=0$, $\mu=1$ and $E_{0_{7}}=-2$}
    \end{minipage}\hfill
    \begin{minipage}{0.49\textwidth}
        \includegraphics[width=1\textwidth]{graphs/Eo_analysis/beta0/pi_/pi_m5.png}
        \caption{\footnotesize Simulation parameters: $a=0.05$, $v_0=1$, $\beta_1=0$, $\mu=1$ and $E_{0_{5}}=-5$}
    \end{minipage}
    position and orientation of squirmer1: $(x1,y1)=(-a,0)$, $\theta_1=\frac{\pi}{2}$\\
    position and orientation of squirmer2: $(x2,y2)=(\frac{2a}{1.5},0)$, $\theta_2=\pi$\\
    The arrows shows when the orientations of the squirmers are affected and a circle is plotted every four time the orientation of a squirmer is affected
\end{figure}

\subsection{N squirmers}
The first step was to modify the code done during the initial project to simulate the behavior of $N$ squirmers.

\newpage

\nocite{*}
\bibliographystyle{plain}
\bibliography{bibliography/biblio}
\end{document}